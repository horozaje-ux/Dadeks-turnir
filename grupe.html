<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <title>Dadeks turnir – Grupe i nokaut</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #e5e7eb;
    }

    a { color: inherit; text-decoration: none; }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
    }

    header {
      text-align: center;
      padding: 10px 0 18px;
    }

    header h1 {
      margin: 0;
      font-size: 1.8rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #38bdf8;
    }

    header p {
      margin: 4px 0 0;
      font-size: 0.9rem;
      color: #9ca3af;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
      font-size: 0.8rem;
      cursor: pointer;
      transition: 0.15s;
    }

    .back-link:hover {
      background: #0f172a;
    }

    .years {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 20px 0 12px;
    }

    .year-btn {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.8rem;
      cursor: pointer;
      transition: 0.15s;
    }

    .year-btn.active {
      background: #0ea5e9;
      color: #020617;
      font-weight: 600;
      border-color: transparent;
    }

    .section-title {
      margin-top: 12px;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #9ca3af;
    }

    .groups-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 16px;
      margin-top: 10px;
    }

    .card {
      background: radial-gradient(circle at top left, #0f172a, #020617 55%);
      border-radius: 16px;
      border: 1px solid #1f2937;
      padding: 14px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.75);
    }

    .group-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .group-name {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      color: #bfdbfe;
    }

    .team-count {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: rgba(15, 23, 42, 0.8);
      color: #9ca3af;
    }

    .team-list {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 0.82rem;
    }

    .team-list li {
      padding: 3px 0;
      border-bottom: 1px dashed #1f2937;
    }

    .team-list li:last-child {
      border-bottom: none;
    }

    .knockout-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
      margin-top: 10px;
    }

    .knockout-card h3 {
      margin: 0 0 6px;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      color: #facc15;
    }

    .fixture-list {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 0.8rem;
    }

    .fixture-list li {
      display: flex;
      flex-direction: column;
      padding: 4px 0;
      border-bottom: 1px solid #1f2937;
    }

    .fixture-list li:last-child {
      border-bottom: none;
    }

    .fixture-label {
      color: #9ca3af;
      font-size: 0.76rem;
    }

    .fixture-teams {
      font-weight: 500;
      color: #e5e7eb;
    }

    .fixture-note {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    /* sponsor traka */
    .sponsor-strip {
      margin-top: 26px;
      padding: 10px 14px;
      border-radius: 999px;
      background: #facc15;
      color: #0f172a;
      font-size: 0.78rem;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .sponsor-strip span.logo {
      font-weight: 800;
      padding: 3px 10px;
      border-radius: 999px;
      background: #0f172a;
      color: #facc15;
      margin-left: 6px;
    }

    @media (max-width: 640px) {
      .page { padding: 10px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>Dadeks turnir – Grupe i nokaut</h1>
      <p>Pregled grupa i završnice po godištima</p>

      <a href="index.html" class="back-link">← Nazad na Dadeks turnir 2025</a>
    </header>

    <div class="years">
      <button class="year-btn active" data-year="2015">2015</button>
      <button class="year-btn" data-year="2016">2016</button>
      <button class="year-btn" data-year="2017">2017</button>
      <button class="year-btn" data-year="2018">2018</button>
    </div>

    <p class="section-title" id="year-label">2015. godište</p>

    <!-- GRUPE -->
    <section>
      <h2 class="section-title">Grupe</h2>
      <div id="groups-container" class="groups-grid"></div>
    </section>

    <!-- NOKAUT FAZA -->
    <section style="margin-top:16px;">
      <h2 class="section-title">Nokaut faza</h2>
      <div id="knockout-container" class="knockout-grid"></div>
    </section>

    <!-- sponsor -->
    <div class="sponsor-strip">
      DADEKS TURNIR – GRUPE I NOKAUT · GENERALNI SPONZOR:
      <span class="logo">ŠANSABET.COM</span>
    </div>
  </div>

  <script>
    // SVE EKIPE PO GODIŠTU / GRUPI
    const GROUPS_DATA = {
      "2015": {
        "A": ["Dadeks", "Buducnost", "Akademik Nk", "Desetka Bar", "Fa Kerver 19"],
        "B": ["Pristina", "Fk Berane", "Župa Nk", "Bernabeu", "Danilovgrad 2"],
        "C": ["Herceg Novi", "Karioke Nk", "Danilovgrad 1", "Ilarion", "Podgorica"],
        "D": ["Fenix", "Otrant", "Barsa Bar", "Titan", "Porto"]
      },
      "2016": {
        "A": ["Dadeks", "Durmitor", "Centar", "As 1", "Akademik Nk"],
        "B": ["Herceg Novi", "Buducnost", "Danilovgrad", "Desetka"],
        "C": ["Otrant", "Fudbalito", "Porto", "Zupa", "Bernabeu"],
        "D": ["Onogost", "Barsa", "Stari aerodrom", "As 2", "Akademija Berane"]
      },
      "2017": {
        "A": ["Dadeks", "Karioke Nk", "Titan", "Bernabeu 1", "Tuzi"],
        "B": ["Stari Aerodrom", "Porto", "Fudbalito", "As", "Desetka"],
        "C": ["Nacional", "Berane", "Cijevna", "Danilovgrad", "Ilarion"],
        "D": ["Zlatna lopta", "Ibar", "Buducnost", "Bernabeu 2", "Centar"]
      },
      "2018": {
        "A": ["Dadeks", "Desetka", "Jezero", "Fudbalito 3"],
        "B": ["Zlatna lopta", "Fudbalito 2", "Arena", "Fenix"],
        "C": ["Bernabeu", "Fa Kerver", "Zupa", "Porto"],
        "D": ["Fudbalito 1", "Karioke Nk", "Akademija Berane", "Stari aerodrom"]
      }
    };

    let currentYear = "2015";
    let allMatches = [];

    // UČITAVANJE matches.json
    async function loadMatches() {
      try {
        const resp = await fetch("matches.json?cache=" + Date.now());
        if (!resp.ok) throw new Error("HTTP " + resp.status);
        const data = await resp.json();
        allMatches = data;
      } catch (err) {
        console.error("Greška pri učitavanju matches.json:", err);
        allMatches = [];
      }
    }

    // RAČUNANJE TABELA IZ REZULTATA
    function calculateStandings(year) {
      const groups = GROUPS_DATA[year];
      if (!groups) return {};

      const standings = {};
      // inicijalizacija
      Object.entries(groups).forEach(([grp, teams]) => {
        standings[grp] = teams.map(name => ({
          team: name,
          gp: 0, w: 0, d: 0, l: 0,
          gf: 0, ga: 0, gd: 0, pts: 0
        }));
      });

      const matches = allMatches.filter(m => m.godiste === year);
      matches.forEach(m => {
        const grp = m.grupa;
        const table = standings[grp];
        if (!table) return;

        const home = table.find(t => t.team === m.domacin);
        const away = table.find(t => t.team === m.gost);
        if (!home || !away) return;

        const gh = Number(m.golDom);
        const ga = Number(m.golGost);
        if (Number.isNaN(gh) || Number.isNaN(ga)) return;

        home.gp++; away.gp++;
        home.gf += gh; home.ga += ga;
        away.gf += ga; away.ga += gh;
        home.gd = home.gf - home.ga;
        away.gd = away.gf - away.ga;

        if (gh > ga) {
          home.w++; home.pts += 3; away.l++;
        } else if (gh < ga) {
          away.w++; away.pts += 3; home.l++;
        } else {
          home.d++; away.d++;
          home.pts++; away.pts++;
        }
      });

      // sortiranje
      Object.keys(standings).forEach(grp => {
        standings[grp].sort((a, b) =>
          b.pts - a.pts ||
          b.gd - a.gd ||
          b.gf - a.gf ||
          a.team.localeCompare(b.team, "sr")
        );
      });

      return standings;
    }

    // RENDER GRUPA
    function renderGroups(year) {
      const container = document.getElementById("groups-container");
      const groups = GROUPS_DATA[year];
      if (!groups) {
        container.innerHTML = "<p>Nema podataka za ovo godište.</p>";
        return;
      }

      let html = "";
      Object.entries(groups).forEach(([grp, teams]) => {
        const labelTeams = teams.length + " ekipa" + (teams.length > 1 ? "" : "a");
        html += `
          <div class="card">
            <div class="group-header">
              <span class="group-name">Grupa ${grp}</span>
              <span class="team-count">${labelTeams}</span>
            </div>
            <ul class="team-list">
              ${teams.map(t => `<li>${t}</li>`).join("")}
            </ul>
          </div>`;
      });

      container.innerHTML = html;
    }

    // RENDER NOKAUT FAZE (samo četvrtfinale sa imenima)
    function renderKnockout(year) {
      const container = document.getElementById("knockout-container");
      const standings = calculateStandings(year);

      const A = standings["A"] || [];
      const B = standings["B"] || [];
      const C = standings["C"] || [];
      const D = standings["D"] || [];

      const A1 = A[0]?.team || "Prvak grupe A";
      const A2 = A[1]?.team || "Drugoplasirani grupe A";
      const B1 = B[0]?.team || "Prvak grupe B";
      const B2 = B[1]?.team || "Drugoplasirani grupe B";
      const C1 = C[0]?.team || "Prvak grupe C";
      const C2 = C[1]?.team || "Drugoplasirani grupe C";
      const D1 = D[0]?.team || "Prvak grupe D";
      const D2 = D[1]?.team || "Drugoplasirani grupe D";

      const qf1 = `${A1} – ${C2}`;
      const qf2 = `${A2} – ${C1}`;
      const qf3 = `${B1} – ${D2}`;
      const qf4 = `${B2} – ${D1}`;

      container.innerHTML = `
        <div class="card knockout-card">
          <h3>Četvrtfinale</h3>
          <ul class="fixture-list">
            <li>
              <span class="fixture-label">A1 – C2</span>
              <span class="fixture-teams">${qf1}</span>
              <span class="fixture-note">Prvi iz grupe A vs drugi iz grupe C</span>
            </li>
            <li>
              <span class="fixture-label">A2 – C1</span>
              <span class="fixture-teams">${qf2}</span>
              <span class="fixture-note">Drugi iz grupe A vs prvi iz grupe C</span>
            </li>
            <li>
              <span class="fixture-label">B1 – D2</span>
              <span class="fixture-teams">${qf3}</span>
              <span class="fixture-note">Prvi iz grupe B vs drugi iz grupe D</span>
            </li>
            <li>
              <span class="fixture-label">B2 – D1</span>
              <span class="fixture-teams">${qf4}</span>
              <span class="fixture-note">Drugi iz grupe B vs prvi iz grupe D</span>
            </li>
          </ul>
        </div>

        <div class="card knockout-card">
          <h3>Polufinale</h3>
          <ul class="fixture-list">
            <li>
              <span class="fixture-label">P1: A1C2 – B1D2</span>
              <span class="fixture-note">Pobjednici 1. i 3. četvrtfinala</span>
            </li>
            <li>
              <span class="fixture-label">P2: A2C1 – B2D1</span>
              <span class="fixture-note">Pobjednici 2. i 4. četvrtfinala</span>
            </li>
          </ul>
        </div>

        <div class="card knockout-card">
          <h3>Finale</h3>
          <ul class="fixture-list">
            <li>
              <span class="fixture-label">P1 – P2</span>
              <span class="fixture-note">Pobjednici polufinala</span>
            </li>
          </ul>

          <h3 style="margin-top:12px;">Utakmica za 3. mjesto</h3>
          <ul class="fixture-list">
            <li>
              <span class="fixture-label">P1 (poraženi) – P2 (poraženi)</span>
              <span class="fixture-note">Poraženi u polufinalu</span>
            </li>
          </ul>
        </div>
      `;
    }

    // PROMJENA GODIŠTA
    function setYear(year) {
      currentYear = year;
      document.getElementById("year-label").textContent = year + ". godište";

      document.querySelectorAll(".year-btn").forEach(btn => {
        btn.classList.toggle("active", btn.dataset.year === year);
      });

      renderGroups(year);
      renderKnockout(year);
    }

    // INIT
    document.addEventListener("DOMContentLoaded", async () => {
      // klik na godine
      document.querySelectorAll(".year-btn").forEach(btn => {
        btn.addEventListener("click", () => setYear(btn.dataset.year));
      });

      await loadMatches();       // učitamo rezultate
      setYear("2015");           // podrazumijevano
    });
  </script>
</body>
</html>
